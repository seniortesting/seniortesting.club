<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Debian MYSQL8安装及其环境配置 | 胡言胡语</title><meta name="keywords" content="软件测试,软测,软件开发,测试开发,高级测试,测试管理,测试面试,高级测试开发,测试技巧,测试管理,测试工具,自动化测试,性能测试,api测试,接口测试,grpc测试,rpc测试,胡言乱语,胡言语,pytest,cypress,selenium,jmeter,karate,言小妹"><meta name="author" content="言小妹"><meta name="copyright" content="言小妹"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="安装步骤如下命令::: warning mysql安装密码问题  安装的时候注意选择legecal password,否则wordpress不能访问mysql8数据库 如果是raspberry,则必须安装mariadb:::  安装命令 1. mysql8安装，注意配置大小写安装 1234567891011$ apt-get install lsb-release$ wget https:&amp;#x2"><meta property="og:type" content="article"><meta property="og:title" content="Debian MYSQL8安装及其环境配置"><meta property="og:url" content="https://seniortesting.club/posts/14FD638/index.html"><meta property="og:site_name" content="胡言胡语"><meta property="og:description" content="安装步骤如下命令::: warning mysql安装密码问题  安装的时候注意选择legecal password,否则wordpress不能访问mysql8数据库 如果是raspberry,则必须安装mariadb:::  安装命令 1. mysql8安装，注意配置大小写安装 1234567891011$ apt-get install lsb-release$ wget https:&amp;#x2"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl21.jpeg"><meta property="article:published_time" content="2021-04-15T08:21:27.903Z"><meta property="article:modified_time" content="2021-04-15T08:21:27.903Z"><meta property="article:author" content="言小妹"><meta property="article:tag" content="软件测试,软测,软件开发,测试开发,高级测试,测试管理,测试面试,高级测试开发,测试技巧,测试管理,测试工具,自动化测试,性能测试,api测试,接口测试,grpc测试,rpc测试,胡言乱语,胡言语,pytest,cypress,selenium,jmeter,karate,言小妹"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl21.jpeg"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://seniortesting.club/posts/14FD638/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"top-center"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-04-15 16:21:27"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)});const t=saveToLocal.get("aside-status");void 0!==t&&("hide"===t?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const o=saveToLocal.get("global-font-size");void 0!==o&&document.documentElement.style.setProperty("--global-font-size",o+"px")})(window)</script><style>.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;margin:.2rem 0;background-color:var(--btn-bg);color:var(--btn-color);line-height:1.6rem;transition:all .3s;position:relative;z-index:1}</style><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="胡言胡语" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">59</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-file-archive"></i> <span>课程系列</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/Java/java%E5%9F%BA%E7%A1%80/"><i class="fa-fw fas fa-coffee"></i> <span>java基础系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96/junit5%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-thumbs-up"></i> <span>junit5系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96/pytest%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-balance-scale"></i> <span>pytest系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/cypress%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-graduation-cap"></i> <span>cypress系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/playwright%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-wrench"></i> <span>playwright系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/puppeteer%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-gem"></i> <span>puppeteer系列</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">胡言胡语</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-file-archive"></i> <span>课程系列</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/Java/java%E5%9F%BA%E7%A1%80/"><i class="fa-fw fas fa-coffee"></i> <span>java基础系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96/junit5%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-thumbs-up"></i> <span>junit5系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96/pytest%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-balance-scale"></i> <span>pytest系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/cypress%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-graduation-cap"></i> <span>cypress系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/playwright%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-wrench"></i> <span>playwright系列</span></a></li><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UI%E8%87%AA%E5%8A%A8%E5%8C%96/puppeteer%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-gem"></i> <span>puppeteer系列</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Debian MYSQL8安装及其环境配置<a class="post-edit-link" href="https://github.com/seniortesting/seniortesting.club/edit/main/source/_posts/数据库/mysql安装和环境配置.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2021-04-15T08:21:27.903Z" title="undefined 2021-04-15 16:21:27">2021-04-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Debian MYSQL8安装及其环境配置"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/14FD638/#post-comment"><span id="twikoo-count"></span></a></span></div></div></div><article class="post-content" id="article-container"><h1 id="安装步骤如下命令"><a href="#安装步骤如下命令" class="headerlink" title="安装步骤如下命令"></a>安装步骤如下命令</h1><p>::: warning mysql安装密码问题</p><ol><li>安装的时候注意选择legecal password,否则wordpress不能访问mysql8数据库</li><li>如果是raspberry,则必须安装mariadb<br>:::</li></ol><h2 id="安装命令"><a href="#安装命令" class="headerlink" title="安装命令"></a>安装命令</h2><p><strong>1. mysql8安装，注意配置大小写安装</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get install lsb-release</span><br><span class="line">$ wget https:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;mysql-apt-config_0.8.13-1_all.deb</span><br><span class="line">$ sudo dpkg -i mysql-apt-config*</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install mysql-server mysql-common</span><br><span class="line">&#x2F;&#x2F; 配置数据库表大小写敏感配置</span><br><span class="line">$ sudo systemctl stop mysql.service</span><br><span class="line">$ sudo rm -rf &#x2F;var&#x2F;lib&#x2F;mysql</span><br><span class="line">$ 此处需要执行命令: &#96;sudo nano &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#96;,添加下方的配置: &#96; lower_case_table_names &#x3D; 1&#96;</span><br><span class="line">$ sudo systemctl start mysql.service</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>2. mariadb安装</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install mariadb-server</span><br><span class="line">sudo systemctl status mariadb</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="mysqld-cnf配置参数"><a href="#mysqld-cnf配置参数" class="headerlink" title="mysqld.cnf配置参数"></a>mysqld.cnf配置参数</h2><p><strong>1. mysql配置文件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf</span><br></pre></td></tr></table></figure><p><strong>2. mariadb配置文件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo &#x2F;etc&#x2F;mysql&#x2F;mariadb.conf.d&#x2F;50-server.cnf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>修改以上的配置文件,注意一定要在<code>mysqld</code>区域放入以下的配置信息:</strong></p><ol><li><code>**master**</code>主数据库写数据&lt;通用配置&gt;:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">port &#x3D; 1876</span><br><span class="line"># 数据表以小写保存，但是比较数据表的时候不区分大小写</span><br><span class="line">lower_case_table_names&#x3D;1</span><br><span class="line">default-time-zone&#x3D;&#39;+08:00&#39;</span><br><span class="line"># The number of seconds that the mysqld server waits for a connect packet before responding with Bad handshake. The default value is 10 seconds.</span><br><span class="line"># 所有的参数列表： https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;8.0&#x2F;en&#x2F;server-system-variables.html</span><br><span class="line">connect_timeout &#x3D;100</span><br><span class="line"># 默认 28800，8小时</span><br><span class="line">#当一个连接的空闲时间超过8小时后，MySQL 就会断开该连接，而 c3p0&#x2F;dbcp 连接池则以为该被断开的连接依然有效。MySQL server has gone away</span><br><span class="line">wait_timeout&#x3D;100</span><br><span class="line">#默认 28800，8小时</span><br><span class="line">interactive_timeout&#x3D;100</span><br><span class="line"># MySQL默认的最大连接数为100，MySQL服务器支持允许的最大连接数16384</span><br><span class="line">#对mysql初始化内存影响这么大</span><br><span class="line"># 如果设置的太小： 1040-Too many connections，例如当前Max_used_connections&#x3D;98也会出现这个错误：</span><br><span class="line"># 所以合理的设置是： Max_used_connections &#x2F; max_connections * 100% ≈ 85%</span><br><span class="line"># 参考</span><br><span class="line">max_connections&#x3D;1000</span><br><span class="line">max_user_connections&#x3D;850</span><br><span class="line"></span><br><span class="line"># 设置用户密码加密方式</span><br><span class="line">default_authentication_plugin&#x3D;mysql_native_password</span><br><span class="line">log_bin_trust_function_creators&#x3D;1</span><br><span class="line"># 配置主从复制</span><br><span class="line">log-bin&#x3D;mysql-bin</span><br><span class="line">server-id&#x3D;1</span><br><span class="line"># 配置慢查询</span><br><span class="line">slow_query_log &#x3D; ON</span><br><span class="line">slow_query_log_file &#x3D; &#x2F;logs&#x2F;mysql&#x2F;slow.log</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li><code>**slave**</code>从数据库读数据库(可选):</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">port &#x3D; 1876</span><br><span class="line"># 数据表以小写保存，但是比较数据表的时候不区分大小写</span><br><span class="line">lower_case_table_names&#x3D;1</span><br><span class="line">default-time-zone&#x3D;&#39;+08:00&#39;</span><br><span class="line"># The number of seconds that the mysqld server waits for a connect packet before responding with Bad handshake. The default value is 10 seconds.</span><br><span class="line"># 所有的参数列表： https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;8.0&#x2F;en&#x2F;server-system-variables.html</span><br><span class="line">connect_timeout &#x3D;100</span><br><span class="line"># 默认 28800，8小时</span><br><span class="line">#当一个连接的空闲时间超过8小时后，MySQL 就会断开该连接，而 c3p0&#x2F;dbcp 连接池则以为该被断开的连接依然有效。MySQL server has gone away</span><br><span class="line">wait_timeout&#x3D;100</span><br><span class="line">#默认 28800，8小时</span><br><span class="line">interactive_timeout&#x3D;100</span><br><span class="line"># MySQL默认的最大连接数为100，MySQL服务器支持允许的最大连接数16384</span><br><span class="line">#对mysql初始化内存影响这么大</span><br><span class="line"># 如果设置的太小： 1040-Too many connections，例如当前Max_used_connections&#x3D;98也会出现这个错误：</span><br><span class="line"># 所以合理的设置是： Max_used_connections &#x2F; max_connections * 100% ≈ 85%</span><br><span class="line"># 参考</span><br><span class="line">max_connections&#x3D;1000</span><br><span class="line">max_user_connections&#x3D;850</span><br><span class="line"></span><br><span class="line"># 设置默认户密码加密方式</span><br><span class="line">default_authentication_plugin&#x3D;mysql_native_password</span><br><span class="line">log_bin_trust_function_creators&#x3D;1</span><br><span class="line"># 配置主从复制数据库,为了更好主从复制(io进程和sql进程的操作)低延迟，关闭binlog等</span><br><span class="line">server-id&#x3D;2</span><br><span class="line">skip-log-bin</span><br><span class="line"># 1062 Duplicate entry</span><br><span class="line"># slave-skip-errors&#x3D;1062,1053,1146 #跳过指定error no类型的错误</span><br><span class="line">slave-skip-errors&#x3D;all #跳过所有错误，这个一定要配置，避免不必要的错误导致主从复制失败</span><br><span class="line"># 配置慢查询</span><br><span class="line">slow_query_log &#x3D; 1</span><br><span class="line">slow_query_log_file &#x3D; &#x2F;logs&#x2F;mysql&#x2F;slow.log</span><br><span class="line">long_query_time &#x3D; 5</span><br></pre></td></tr></table></figure><h2 id="配置mysql的用户和密码"><a href="#配置mysql的用户和密码" class="headerlink" title="配置mysql的用户和密码"></a>配置mysql的用户和密码</h2><p>在mysql或者mariadb上运行如下命令进行配置数据库，注意禁止: <strong>VALIDATE PASSWORD COMPONENT</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1. 初始化配置数据库</span><br><span class="line">#  sudo mysql_secure_installation</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">1.  VALIDATE PASSWORD COMPONENT选择为no，这样不用验证password的加密程度</span><br><span class="line">2.  此处root密码可以随便设置一个，因为下面的第三步会重新设置root密码</span><br><span class="line"></span><br><span class="line">-----------------------------------------------</span><br><span class="line">&#x2F;&#x2F; 如果不先设置mysql的密码策略登录的时候会包错误: ERROR 1698 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39;</span><br><span class="line">$ mysql -u root -p (直接不输入密码)</span><br><span class="line"></span><br><span class="line">2. 查看用户密码设置方式</span><br><span class="line">&gt; use mysql;</span><br><span class="line">&gt; SELECT User, Host, plugin FROM mysql.user;</span><br><span class="line"></span><br><span class="line">3. 修改root用户密码插件和密码,参考文档： </span><br><span class="line">1. 推荐文档： https:&#x2F;&#x2F;www.tecmint.com&#x2F;reset-root-password-in-mysql-8&#x2F;</span><br><span class="line">2. 官方文档： https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;8.0&#x2F;en&#x2F;resetting-permissions.html</span><br><span class="line">&gt; use mysql;</span><br><span class="line">&gt; UPDATE mysql.user SET plugin&#x3D;&#39;mysql_native_password&#39; WHERE User&#x3D;&#39;root&#39;;</span><br><span class="line">&gt; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Evxx@90&amp;2qvGJ6Q&#x3D;&#39;;</span><br><span class="line">&gt; FLUSH PRIVILEGES;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="添加数据库和用户-包括修改用户密码"><a href="#添加数据库和用户-包括修改用户密码" class="headerlink" title="添加数据库和用户(包括修改用户密码)"></a>添加数据库和用户(包括修改用户密码)</h2><p>logged in mysql using <code>root / xxx</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1. 创建用户</span><br><span class="line">&gt; create user &#39;syscorer&#39;@&#39;%&#39; identified by &#39;test%&#39;; </span><br><span class="line">&gt; FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">2. 用户权限赋值</span><br><span class="line">WITH GRANT OPTION 这个选项表示该用户可以将自己拥有的权限授权给别人。注意：经常有人在创建操作用户的时候不指定WITH GRANT OPTION选项导致后来该用户不能使用GRANT命令创建用户或者给其它用户授权。</span><br><span class="line">如果不想这个用户有这个grant的权限，可以不加这句</span><br><span class="line"></span><br><span class="line">&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;syscorer&#39;@&#39;%&#39;; </span><br><span class="line">&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;syscorer&#39;@&#39;%&#39; WITH GRANT OPTION;</span><br><span class="line">&gt; FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">3. (可选)修改普通用户密码:</span><br><span class="line">&gt; update user set password&#x3D;PASSWORD(&#39;cTpofe3IwUuzzuqk5Hw2fg&#x3D;P*&amp;35XO2@o)&#x3D;0&#39;) where user&#x3D;&#39;tester&#39;;</span><br><span class="line">&gt; FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">4. 授权特定数据库访问权限，例如数据库testdb</span><br><span class="line"></span><br><span class="line">&gt; GRANT ALL PRIVILEGES ON wp_data.* TO &#39;syscorer&#39;@&#39;%&#39; WITH GRANT OPTION;</span><br><span class="line">&gt; FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><h2 id="mysql8数据表大小写敏感（可选-上面第二步已经设置）"><a href="#mysql8数据表大小写敏感（可选-上面第二步已经设置）" class="headerlink" title="mysql8数据表大小写敏感（可选,上面第二步已经设置）"></a>mysql8数据表大小写敏感（可选,上面第二步已经设置）</h2><p>查看大小写配置，大小写是否敏感:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show variables where Variable_name&#x3D;&#39;lower_case_table_names&#39;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>设置<code>lower_case_table_names = 1</code>，以便在数据库中使用不区分大小写的表名。 我编辑了<code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>，并在[mysqld]下添加了上面的配置。收到以下错误:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Job for mysql.service failed because the control process exited with error code.</span><br><span class="line">See &quot;systemctl status mysql.service&quot; and &quot;journalctl -xe&quot; for details.</span><br></pre></td></tr></table></figure><p>查看mysql的日志文件: <code>tail -f -n 100 /var/log/mysql/error.log</code>,查看MySQL官方文档，有记录：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lower_case_table_names can only be configured when initializing the server. Changing the lower_case_table_names setting after the server is initialized is prohibited.</span><br></pre></td></tr></table></figure><p>只有在初始化的时候设置 lower_case_table_names=1才有效，比如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--initialize --lower-case-table-names&#x3D;1</span><br></pre></td></tr></table></figure><h2 id="读写分离配置"><a href="#读写分离配置" class="headerlink" title="读写分离配置"></a>读写分离配置</h2><ol><li>配置读写分离的数据库用户:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> 1.1 master数据库中执行如下命令: </span><br><span class="line"> </span><br><span class="line"> mysql&gt;  CREATE USER &#39;repdev&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;testh&#39;;</span><br><span class="line"> mysql&gt;  GRANT REPLICATION SLAVE ON *.* TO &#39;repdev&#39;@&#39;%&#39;;</span><br><span class="line"> mysql&gt;  flush privileges;</span><br><span class="line"> </span><br><span class="line"> mysql&gt; SHOW MASTER STATUS;</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| mysql-bin.000001 |     2035 |              |                  |                   |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 1.2 slave节点数据库:   注意MASTER_LOG_FILE和MASTER_LOG_POS是master的正确值,命令如下:</span><br><span class="line"></span><br><span class="line">mysql&gt; stop slave;</span><br><span class="line"></span><br><span class="line">mysql&gt;  CHANGE MASTER TO</span><br><span class="line">MASTER_HOST&#x3D;&#39;47.101.187.237&#39;,</span><br><span class="line">MASTER_PORT&#x3D;1876,</span><br><span class="line">MASTER_USER&#x3D;&#39;repdev&#39;,</span><br><span class="line">MASTER_PASSWORD&#x3D;&#39;testh&#39;,</span><br><span class="line">MASTER_LOG_FILE&#x3D;&#39;mysql-bin.000009&#39;,</span><br><span class="line">MASTER_LOG_POS&#x3D;17975043;</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave; </span><br><span class="line">mysql&gt; show slave status\G;</span><br><span class="line"></span><br><span class="line">如果显示的:  Seconds_Behind_Master(主从延时),  Slave_IO_Running&#x3D;Yes, Slave_SQL_Running&#x3D;Yes</span><br><span class="line"></span><br><span class="line"># 修改对应的slave对应的master的log-bin文件</span><br><span class="line">Mysql&gt; CHANGE MASTER TO MASTER_LOG_FILE&#x3D;&#39;mysql-bin.000003&#39;,MASTER_LOG_POS&#x3D;342;</span><br></pre></td></tr></table></figure><p>说明:  Seconds_Behind_Master参数值<br>NULL - 表示io_thread或是sql_thread有任何一个发生故障，也就是该线程的Running状态是No,而非Yes.<br>0 - 该值为零，是我们极为渴望看到的情况，表示主从复制良好，可以认为lag不存在。</p><h3 id="读写分离报错问题"><a href="#读写分离报错问题" class="headerlink" title="读写分离报错问题"></a>读写分离报错问题</h3><p>1.记录删除失败 <code>Could not execute Delete_rows event on table cvr.sys_user; Can&#39;t find record in &#39;sys_user&#39;, Error_code: 1032; handler error HA_ERR_KEY_NOT_FOUND; the event&#39;s master log mysql-bin.000005, end_log_pos 46653957</code>错误<br>解决方法：master要删除一条记录，而slave上找不到报错，这种情况主都已经删除了，那么从机可以直接跳过指定数量的错误。</p><h1 id="将同步指针向下移动一个，如果多次不同步可以重复操作"><a href="#将同步指针向下移动一个，如果多次不同步可以重复操作" class="headerlink" title="将同步指针向下移动一个，如果多次不同步可以重复操作"></a>将同步指针向下移动一个，如果多次不同步可以重复操作</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stop slave;set global sql_slave_skip_counter=1;SELECT SLEEP(5);start slave;</span><br></pre></td></tr></table></figure><p>If the error is still there, set a bigger value in sql_slave_skip_counter like:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">set</span> global sql_slave_skip_counter=1000;</span></span><br></pre></td></tr></table></figure><p>Again, check the status of the slave.</p><p>If you find the skip_sql value is non zero in the slave status then stop the slave again and do:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">set</span> global sql_slave_skip_counter=0;</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> start slave;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>主键重复<code>Last_SQL_Error: Could not execute Write_rows event on table hcy.t1; Duplicate entry &#39;2&#39; for key &#39;PRIMARY&#39;, Error_code: 1062; handler error HA_ERR_FOUND_DUPP_KEY; the event&#39;s master log mysql-bin.000006, end_log_pos 924</code></li></ol><p>在slave已经有该记录，又在master上插入了同一条记录。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Last_SQL_Error: Could not execute Write_rows event on table hcy.t1; Duplicate entry &#39;2&#39; for key &#39;PRIMARY&#39;, Error_code: 1062; handler error HA_ERR_FOUND_DUPP_KEY; the event&#39;s master log mysql-bin.000006, end_log_pos 924</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="3"><li>终极解决所有的主从错误同步问题</li></ol><p>直接在<code>mysqld.cnf</code>文件中配置如下忽略所有的错误:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slave-skip-errors&#x3D;all</span><br></pre></td></tr></table></figure><h2 id="忘记root密码重置root密码"><a href="#忘记root密码重置root密码" class="headerlink" title="忘记root密码重置root密码"></a>忘记root密码重置root密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl  stop mysql</span><br><span class="line">sudo mysqld_safe --skip-grant-tables --skip-networking &amp;</span><br><span class="line"># 重启一个命令行窗口执行如下命令</span><br><span class="line">mysql -u root;</span><br><span class="line">use mysql;</span><br><span class="line">SELECT User, Host, plugin FROM mysql.user;</span><br><span class="line">update user set plugin&#x3D;&#39;mysql_native_password&#39; where user&#x3D;&#39;root&#39;;</span><br><span class="line">flush privileges;</span><br><span class="line">ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;cTpofe3IwUuzzuOq0k5Hw2fg&#x3D;&#39;;</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>如果报： <code>ERROR 1290 (HY000): The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement</code>,需要执行一下命令: <code>flush privileges</code>,然后再重新执行命令就好了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># mysql_config_editor set \</span><br><span class="line">    --login-path&#x3D;dev\</span><br><span class="line">    --host&#x3D;localhost \</span><br><span class="line">    --user&#x3D;root \</span><br><span class="line">    --password</span><br><span class="line"># mysql --login-path&#x3D;dev</span><br></pre></td></tr></table></figure><h2 id="卸载mysql操作"><a href="#卸载mysql操作" class="headerlink" title="卸载mysql操作"></a>卸载mysql操作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;var&#x2F;lib&#x2F;dpkg</span><br><span class="line">sudo mv info info.bak</span><br><span class="line">sudo mkdir info</span><br><span class="line">sudo dpkg --configure -a</span><br><span class="line">sudo apt-get install -f</span><br><span class="line">sudo mv &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info&#x2F;* &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info.bak</span><br><span class="line">sudo rm -rf &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info</span><br><span class="line">sudo mv &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info.bak &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info</span><br><span class="line">sudo apt remove --purge mysql*</span><br><span class="line"></span><br><span class="line">sudo apt remove mysql-server</span><br><span class="line">sudo apt purge mysql-server</span><br><span class="line">sudo apt autoremove</span><br><span class="line">sudo find &#x2F; -name mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="安装错误异常"><a href="#安装错误异常" class="headerlink" title="安装错误异常"></a>安装错误异常</h2><blockquote><p>error processing package mysql-community-server (–configure):<br>dependency problems - leaving unconfigured</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt --yes autoremove --purge mysql-server</span><br><span class="line">sudo apt --yes autoremove --purge mysql-client</span><br><span class="line">sudo rm &#x2F;var&#x2F;lib&#x2F;mysql&#x2F; -R</span><br><span class="line">sudo rm &#x2F;etc&#x2F;mysql&#x2F; -R</span><br><span class="line">sudo apt-get autoremove mysql* --purge</span><br><span class="line">sudo apt-get remove apparmor</span><br><span class="line">sudo apt-get install mysql-server mysql-common</span><br></pre></td></tr></table></figure><h2 id="mysql8备份还原从数据文件，-backup-restore"><a href="#mysql8备份还原从数据文件，-backup-restore" class="headerlink" title="mysql8备份还原从数据文件， backup, restore"></a>mysql8备份还原从数据文件， backup, restore</h2><ol><li>（<del>以下的操作没有成功</del>）通常mysql的数据库文件目录为: <strong>/var/lib/mysql</strong></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl stop mysql</span><br><span class="line"># 复制数据盘的mysql的数据库文件夹（例如：cvr)到新的mysql数据库目录： &#x2F;var&#x2F;lib&#x2F;mysql</span><br><span class="line">$ sudo cp -R &#x2F;opt&#x2F;mysql&#x2F;cvr &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;</span><br><span class="line"># 配置权限</span><br><span class="line">$ sudo chown -R mysql:mysql &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;cvr</span><br><span class="line">$ sudo chmod -R 660 &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;cvr</span><br><span class="line">$ sudo chown  mysql:mysql &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;cvr </span><br><span class="line">$ sudo chmod 700 &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;cvr</span><br><span class="line"></span><br><span class="line">$ sudo systemctl restart mysql</span><br><span class="line">$ sudo mysql -u root -p</span><br><span class="line">&gt; show databases;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li>采用sql文件进行恢复数据库,注意不同数据库记得切换下</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p cvr &lt; cvr.sql</span><br></pre></td></tr></table></figure><h2 id="navicat连接mysql-navicat-received-invalid-response-to-SSL-negotiation-j"><a href="#navicat连接mysql-navicat-received-invalid-response-to-SSL-negotiation-j" class="headerlink" title="navicat连接mysql: navicat received invalid response to SSL negotiation: j"></a>navicat连接mysql: navicat received invalid response to SSL negotiation: j</h2><p>最近通过navicat连接mysql遇到一个提示问题： <code>navicat received invalid response to SSL negotiation: j</code>,而通过其他的mysql客户端可以正常连接，比如 dbforge for MYSQL。 很奇怪，所以确定是navicat那里配置出了问题。</p><p>网上查了一下一下这个问题，有的说在连接对话框中，查看下SSL和SSH是否勾选了。查了下确认没有勾选，如下：<br><img src="https://raw.githubusercontent.com/alterhu2020/StorageHub/master/img/20200718092633-2020-07-18.png" alt="20200718092633-2020-07-18"><br><img src="https://raw.githubusercontent.com/alterhu2020/StorageHub/master/img/20200718092659-2020-07-18.png" alt="20200718092659-2020-07-18"></p><p>我就很奇怪了，于是删除这个连接，重新新建一个连接。点击“测试连接”，居然可以正常连接访问mysql。所以遇到问题时，千万不要钻牛角尖，换个思路看看，没准柳暗花明。</p><h2 id="mysql字符集和排序规则"><a href="#mysql字符集和排序规则" class="headerlink" title="mysql字符集和排序规则"></a>mysql字符集和排序规则</h2><p>navicat中新建数据库中回选择对应的<strong>字符集</strong>和<strong>排序规则</strong>。</p><ul><li>字符集，这里只要关注两个：utf8和utf8mb4。字符集以_ci（大小写不敏感）、_cs（大小写敏感）或_bin（二元）结束。</li><li>mysql(字符串)排序规则区别</li></ul><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>utf8_bin （utf8mb4_bin）</td><td>将字符串中的每一个字符用二进制数据存储，区分大小写。</td></tr><tr><td>utf8_general_ci（utf8mb4_general_ci）</td><td>不区分大小写，ci为case insensitive的缩写，即大小写不敏感。</td></tr><tr><td>utf8_general_cs（utf8mb4_general_cs）</td><td>区分大小写，cs为case sensitive的缩写，即大小写敏感。</td></tr><tr><td></td><td></td></tr><tr><td>code varchar(20) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT ‘唯一码’</td><td></td></tr></tbody></table><h2 id="mysql密码策略不满足"><a href="#mysql密码策略不满足" class="headerlink" title="mysql密码策略不满足"></a>mysql密码策略不满足</h2><p>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</p><p>使用如下的命令检查mysql密码的验证策略：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#39;validate_password%&#39;;</span><br></pre></td></tr></table></figure><p>然后会输出类似如下的结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------------------+-------+</span><br><span class="line">| Variable_name                        | Value |</span><br><span class="line">+--------------------------------------+-------+</span><br><span class="line">| validate_password.check_user_name    | ON    |</span><br><span class="line">| validate_password.dictionary_file    |       |</span><br><span class="line">| validate_password.length             | 8     |</span><br><span class="line">| validate_password.mixed_case_count   | 1     |</span><br><span class="line">| validate_password.number_count       | 1     |</span><br><span class="line">| validate_password.policy             |MEDIUM |</span><br><span class="line">| validate_password.special_char_count | 1     |</span><br><span class="line">+--------------------------------------+-------+</span><br></pre></td></tr></table></figure><p>如果需要删除这个校验规则，执行如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; uninstall plugin validate_password;</span><br></pre></td></tr></table></figure><h2 id="Could-not-open-or-create-the-system-tablespace-If-you-tried-to-add-new-data-files-to-the-system-tablespace-and-it-failed-here-you-should-now-edit-innodb-data-file-path-in-my-cnf-back-to-what-it-was-and-remove-the-new-ibdata-files-InnoDB-created-in-this-failed-attempt-InnoDB-only-wrote-those-files-full-of-zeros-but-did-not-yet-use-them-in-any-way-But-be-careful-do-not-remove-old-data-files-which-contain-your-precious-data"><a href="#Could-not-open-or-create-the-system-tablespace-If-you-tried-to-add-new-data-files-to-the-system-tablespace-and-it-failed-here-you-should-now-edit-innodb-data-file-path-in-my-cnf-back-to-what-it-was-and-remove-the-new-ibdata-files-InnoDB-created-in-this-failed-attempt-InnoDB-only-wrote-those-files-full-of-zeros-but-did-not-yet-use-them-in-any-way-But-be-careful-do-not-remove-old-data-files-which-contain-your-precious-data" class="headerlink" title="Could not open or create the system tablespace. If you tried to add new data files to the system tablespace, and it failed here, you should now edit innodb_data_file_path in my.cnf back to what it was, and remove the new ibdata files InnoDB created in this failed attempt. InnoDB only wrote those files full of zeros, but did not yet use them in any way. But be careful: do not remove old data files which contain your precious data"></a>Could not open or create the system tablespace. If you tried to add new data files to the system tablespace, and it failed here, you should now edit innodb_data_file_path in my.cnf back to what it was, and remove the new ibdata files InnoDB created in this failed attempt. InnoDB only wrote those files full of zeros, but did not yet use them in any way. But be careful: do not remove old data files which contain your precious data</h2><p>进入mysql的数据目录,注意备份：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd  &#x2F;var&#x2F;lib&#x2F;mysql</span><br><span class="line">rm -rf ib_logfile*</span><br><span class="line">rm -rf ibdata1</span><br></pre></td></tr></table></figure><h2 id="mysql-shell-脚本Using-a-password-on-the-command-line-interface-can-be-insecure"><a href="#mysql-shell-脚本Using-a-password-on-the-command-line-interface-can-be-insecure" class="headerlink" title="mysql shell 脚本Using a password on the command line interface can be insecure"></a>mysql shell 脚本Using a password on the command line interface can be insecure</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">言小妹</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://seniortesting.club/posts/14FD638/">https://seniortesting.club/posts/14FD638/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://seniortesting.club" target="_blank">胡言胡语</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl21.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-6t+ed+2i-1n-4w" data-ad-client="ca-pub-1893384651266286" data-ad-slot="2627967536"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/1VEP3Y5/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl16.jpeg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">dbForge Studio 2020 for MySQL v9.0.338破解安装包下载</div></div></a></div><div class="next-post pull-right"><a href="/posts/1GD38XB/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/20210414194725.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Scrapy爬虫配置</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-info__name">言小妹</div><div class="author-info__description">非学无以广才,非志无以成学</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">59</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/alterhu2020"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/seniortesting/seniortesting.club" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:alterhu2020@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%E5%A6%82%E4%B8%8B%E5%91%BD%E4%BB%A4"><span class="toc-number">1.</span> <span class="toc-text">安装步骤如下命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.</span> <span class="toc-text">安装命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysqld-cnf%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">mysqld.cnf配置参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEmysql%E7%9A%84%E7%94%A8%E6%88%B7%E5%92%8C%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.</span> <span class="toc-text">配置mysql的用户和密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E7%94%A8%E6%88%B7-%E5%8C%85%E6%8B%AC%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">1.4.</span> <span class="toc-text">添加数据库和用户(包括修改用户密码)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql8%E6%95%B0%E6%8D%AE%E8%A1%A8%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F%EF%BC%88%E5%8F%AF%E9%80%89-%E4%B8%8A%E9%9D%A2%E7%AC%AC%E4%BA%8C%E6%AD%A5%E5%B7%B2%E7%BB%8F%E8%AE%BE%E7%BD%AE%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">mysql8数据表大小写敏感（可选,上面第二步已经设置）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E9%85%8D%E7%BD%AE"><span class="toc-number">1.6.</span> <span class="toc-text">读写分离配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.1.</span> <span class="toc-text">读写分离报错问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86%E5%90%8C%E6%AD%A5%E6%8C%87%E9%92%88%E5%90%91%E4%B8%8B%E7%A7%BB%E5%8A%A8%E4%B8%80%E4%B8%AA%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%A4%9A%E6%AC%A1%E4%B8%8D%E5%90%8C%E6%AD%A5%E5%8F%AF%E4%BB%A5%E9%87%8D%E5%A4%8D%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">将同步指针向下移动一个，如果多次不同步可以重复操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%98%E8%AE%B0root%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AEroot%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">忘记root密码重置root密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BDmysql%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">卸载mysql操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%94%99%E8%AF%AF%E5%BC%82%E5%B8%B8"><span class="toc-number">2.3.</span> <span class="toc-text">安装错误异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql8%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E4%BB%8E%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%EF%BC%8C-backup-restore"><span class="toc-number">2.4.</span> <span class="toc-text">mysql8备份还原从数据文件， backup, restore</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#navicat%E8%BF%9E%E6%8E%A5mysql-navicat-received-invalid-response-to-SSL-negotiation-j"><span class="toc-number">2.5.</span> <span class="toc-text">navicat连接mysql: navicat received invalid response to SSL negotiation: j</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"><span class="toc-number">2.6.</span> <span class="toc-text">mysql字符集和排序规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5%E4%B8%8D%E6%BB%A1%E8%B6%B3"><span class="toc-number">2.7.</span> <span class="toc-text">mysql密码策略不满足</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Could-not-open-or-create-the-system-tablespace-If-you-tried-to-add-new-data-files-to-the-system-tablespace-and-it-failed-here-you-should-now-edit-innodb-data-file-path-in-my-cnf-back-to-what-it-was-and-remove-the-new-ibdata-files-InnoDB-created-in-this-failed-attempt-InnoDB-only-wrote-those-files-full-of-zeros-but-did-not-yet-use-them-in-any-way-But-be-careful-do-not-remove-old-data-files-which-contain-your-precious-data"><span class="toc-number">2.8.</span> <span class="toc-text">Could not open or create the system tablespace. If you tried to add new data files to the system tablespace, and it failed here, you should now edit innodb_data_file_path in my.cnf back to what it was, and remove the new ibdata files InnoDB created in this failed attempt. InnoDB only wrote those files full of zeros, but did not yet use them in any way. But be careful: do not remove old data files which contain your precious data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql-shell-%E8%84%9A%E6%9C%ACUsing-a-password-on-the-command-line-interface-can-be-insecure"><span class="toc-number">2.9.</span> <span class="toc-text">mysql shell 脚本Using a password on the command line interface can be insecure</span></a></li></ol></li></ol></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1893384651266286" data-ad-slot="3377657013" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 言小妹</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a><a style="margin-inline:5px" target="_blank" href="https://www.jsdelivr.com/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"})}))</script><script>(()=>{const t=document.getElementById("twikoo-count"),o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"twikoo-comment-7gxq358sd1f410ac",region:"ap-shanghai"},null))},n=()=>{twikoo.getCommentsCount({envId:"twikoo-comment-7gxq358sd1f410ac",region:"ap-shanghai",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.innerText=o[0].count})).catch((function(t){console.error(t)}))},e=(e=!1)=>{"object"==typeof twikoo?(o(),e&&t&&setTimeout(n,0)):getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>{o(),e&&t&&setTimeout(n,0)})};e(!0)})()</script></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/css/butterfly.css"><script data-pjax src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/js/butterfly.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>